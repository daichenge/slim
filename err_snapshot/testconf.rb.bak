require 'iniparse'
require './readconf.rb'
hostname = `hostname`
dbconf = ReadConf.new(hostname,"db")
#check if the proc.log exist or not
File.delete("logs/proc.log") if File::exists?( "logs/proc.log" )
#print process information
dbconf.get_conf("process").each do |k,v|
  if v == 1
    sysFile = File.new("logs/proc.log","a+")
    cmd_list = ["lsof -c #{k}","ps aux|grep #{k}|grep -v grep"]
    cmd_list.each do |cmd|
      sysFile.syswrite(`#{cmd}`)
    end
#print 6 lines
    sysFile.syswrite("\n"*6)
    sysFile.close()
  end
end
